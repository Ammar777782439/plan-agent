==قاعدة:== قبول الاتصالات بشهادات موثوقة (mTLS)  
النوع:واردة

ليش؟ هذه هي أول بوابة يمروا منها العملاء، ولازم نضمن إن اللي بيحاول يتواصل معنا هو عميل معروف وموثوق. ما نفتح الباب لأي أحد.

فين تنفذت؟  
أنا ضبطت هذا الشي في ملف `main.go` داخل `/cmd/server/`. بالتحديد في إعدادات `tls.Config`.

وهذا هو الجزء المسؤول من الكود:
```
GO

// نطلب من العميل يقدم شهادة مصدقة

ClientAuth: tls.RequireAndVerifyClientCert,  

// نحدد من هي الجهة الموثوقة اللي نثق في شهاداتها 
(CA) ClientCAs: caCertPool,`

```

بهذا الشكل، أي عميل ما معاه شهادة صحيحة وموقعة من جهة إحنا نثق فيها، يتم رفضه مباشرة من أول اتصال.




---
### اعدة: رفض الاتصال لو فشل التحقق من الشهادة

**النوع:** صادرة

**ليش؟**  
هذا التصرف يتم بشكل فوري لو فشلت القاعدة الأولى (اللي تتحقق من الشهادة). إحنا ما بنضيع موارد أو وقت على عميل ما قدر يثبت هويته، نوقفه من الباب.

**فين تنفذت؟**  
هذا الشي يتم تلقائياً من قبل مكتبة `gRPC` مع إعدادات `tls`.  
يعني لو العميل ما قدم شهادة صالحة، بيتم رفض الاتصال أثناء عملية المصافحة (TLS Handshake) نفسها، وقبل ما يوصل أي منطق برمجي خاص بنا.